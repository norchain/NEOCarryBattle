# 《卡莱战纪》核心玩法 - 模拟拜占庭问题



《卡莱战纪》是一款核心逻辑上链的区块链卡牌游戏。 是第一款在拜占庭共识网络上**模拟拜占庭将军问题**的链游, 同时也是第一款**靠去中心化连载小说推动**的链游。目前版本由norchain.io 基于NEO区块链基础设施研发。《卡莱》设计时着重考虑了如何能在区块链技术尚有许多限制的情况下尽可能体现其特质，同时探索其潜力。从而使得玩家在游戏获得的不仅是资产投资价值, 更是新鲜有趣的娱乐体验。

本篇主要叙述核心玩法设计，其他内容请参看：

[总介绍](https://github.com/norchain/NEOCarryBattle/blob/master/README.md)

[软分服: 大规模链游解决方案](https://github.com/norchain/NEOCarryBattle/blob/master/%E5%8D%A1%E8%8E%B1%E6%88%98%E7%BA%AA-%E5%88%86%E6%9C%8D.md)

[用去中心化小说影响游戏，检验人性](https://github.com/norchain/NEOCarryBattle/blob/master/%E5%8D%A1%E8%8E%B1%E6%88%98%E7%BA%AA-%E5%B0%8F%E8%AF%B4.md)

[技术: Neunity框架，非对称熵，以及其他](https://github.com/norchain/NEOCarryBattle/blob/master/%E5%8D%A1%E8%8E%B1%E6%88%98%E7%BA%AA-%E6%8A%80%E6%9C%AF.md)



## 1. 核心玩法简介

### 1.1 基本流程

![map](pics/map.jpg)

**卡牌设计**：玩家注册游戏帐户时拿到随机生成的若干卡牌，每张牌是步、弓、骑其中一种，在3x3格子里排成阵型。

**占城挖矿**：地图上遍布历史名城，玩家可以占领一个空城池，也可以去进攻别人的城池。城市领主根据占领时长领取奖励，每个城市的奖励因子不一样。

**战役过程**： 玩家随时可以查看各个城市守军信息。当决定要进攻某城市时，仔细安排自己的卡牌阵型以获得最好的战果预期，然后进入**行军阶段**(若干区块)。在行军阶段结束前，其他玩家均可以加入战局向目标城市进军。他们需要宣称自己支持攻防还是守方（但实际却并不一定，后文讨论。）行军阶段结束后，战局进入**攻城阶段**，各玩家按真实立场对战，战利分数由胜方按**信息补贴**(参看*其他设计特色*)原则分配。

**战役结果** 战争结束后，若守方战败则退出城市，战斗的发起者占领该城后开始享有税收。战败者会在一段时间内失去行动能力(冷却), 也可以使用代币快速恢复.

**代币用途**： 税收和战利赢得的代币可以用来升级玩家卡牌，也可用来投票决定该服务器小说的下一章节（见[小说篇](https://github.com/norchain/NEOCarryBattle/blob/master/%E5%8D%A1%E8%8E%B1%E6%88%98%E7%BA%AA-%E5%B0%8F%E8%AF%B4.md)。



### 1.2 模拟拜占庭难题

拜占庭将军问题背后的故事是：几个将军想协同攻城，必须有足够人共同参与才能成功。在信息传递不便的古代影响你决策的考虑有三方面：

1. 协同攻城的邀约是否可信？也许只是叛徒诱你出兵攻你老巢，但不到战场无法确知真伪。
2. 是否足够多盟友出兵？如果人数不够就会一败涂地，但这点不到战场你同样无法确知。
3. 假如你因以上顾虑固不出兵或中途撤军，最后可能造成盟友损失而从此失去他们信任。

实现这种游戏方式最核心的挑战是如何**制造玩家真实行动和此行动传播到其他玩家的时间差**。作为一款逻辑上链游戏，玩家每步操作都可在链上公共查询，所以这点看似是很难做到的。但是我们最终通过和[maxpown3r](https://github.com/maxpown3r) 及[generalkim00](https://github.com/generalkim00) 的讨论设计了**非对称熵**(Asymmentropy)机制来实现(他俩用同样的机制实现了一个真正的区块链彩票游戏也[参加了比赛](https://github.com/generalkim00/neogame)，非常经典的[合约](https://github.com/generalkim00/neogame/blob/master/SmartContract/NEOLottery/NEOLottery/Class1.cs)值得一读。 非对称熵会在[技术篇](https://github.com/norchain/NEOCarryBattle/blob/master/%E5%8D%A1%E8%8E%B1%E6%88%98%E7%BA%AA-%E6%8A%80%E6%9C%AF.md)更详细讨论。

总之借助这个机制，**玩家的真实行动通过一段时间才会传递到其他玩家**，也可以选择仅仅只放烟雾。对某玩家的行为判断当然不是无据可循。作为一款全逻辑上链游戏，所有玩家的参战历史都公开可查，谁是见利忘义的墙头草，谁是最有信誉的坚定战士，谁和谁明显每次都在线下商量好了暗地协作，谁是最狡猾的局势洞察者，都可以通过参考链上数据进行判断和预测。玩家也因此逐渐形成自己的群落，他们可以用自己的实际行动去扮演率领群雄攻城掠地的英雄，闭关捡漏的实用主义者，声名狼藉的两面派，亦或是倒插一刀的冷血内应。逐渐发展出不同的敌友分析及游戏策略来。



## 2. 玩家操作

作为全链游戏，在享用区块链技术带来的很多便利和特性的同时也可能会带来对玩家体验的限制，其中最主要的是由于区块生成速度慢，单个玩家很难对“服务器”进行频繁操作。

《卡莱》的核心玩法每场战役对链上的写入操作最多只有两次（非对称熵方法中的行动和验证两次, 见[技术篇](https://github.com/norchain/NEOCarryBattle/blob/master/%E5%8D%A1%E8%8E%B1%E6%88%98%E7%BA%AA-%E6%8A%80%E6%9C%AF.md)2.2），操作的间隔会因各服配置不同以满足不同玩家的娱乐倾向，最小的间隔可能是2、3分钟，最长可能是数小时(详见[软分服](https://github.com/norchain/NEOCarryBattle/blob/master/%E5%8D%A1%E8%8E%B1%E6%88%98%E7%BA%AA-%E5%88%86%E6%9C%8D.md))。升级卡牌和交易更是低频操作。因此单用户不会对链流量造成过大压力。

那么除了链交互外，如何让玩家获得持续有趣而有利的互动体验呢。很多传统游戏里给了我们启发：比如挂机游戏需要等待资源涨足才能做有意义的操作，再比如《[瘟疫公司](https://www.ndemiccreations.com/en/22-plague-inc)》也有大量等待的过程。

### 2.1 调研和模拟

![battle](pics/Battle.jpg)

分服的玩家数量规模一般不会太大(我们初步估略上限可能在30-50，同技术篇所述，也是为了限制合约查找卡牌和玩家的成本)，使得战前充分研究具有可行性，理性类型的玩家为获得最达胜率。可以做的准备包括：

- 查看玩家即将攻击城市的历史记录，研究现在的城主的人气和潜在的盟友。
- 思考其他玩家信息真伪。玩家会通过客户端查询比较各种数据，查看特定玩家之前在攻守同盟时的放鸽子记录，尤其是他声明要帮助你攻城或守城时。
- 调整卡牌阵型来模拟战争。在进攻之前，可以充分调整自己的出战阵型，尽量保证胜率的最大化。 

### 2.2 本地随机事件

![map](pics/map.jpg)

我们也引入一些有趣的因子来让玩家能频繁进行本地交互，纯为增强用户体验，交互结果在客户端可能表现壮丽，但对数据影响可能微乎其微。

**加速税收：**《卡莱》里玩家一个重要的收入来源是占城收税。所以玩家在等待期间可以通过点击地图上的城池来非常少比例的影响税收。具体说来，他们可以像挂机游戏一样不停点自己的城池来暂时增加一些税收。但不管玩家点的多快多爽，客户端逻辑将隔段时间才统一向链提交一次，对税收的影响最快也不会超过1%。（有点类似挂机游戏里的手动挖矿）

**积极性因子** 客户端会随时在地图上生成一些事件，玩家对事件的积极响应会小幅影响随后一段时间的战争结果，性质和影响力和**加速税收** 类似。某些事件还会触发内置的小游戏。积极性因子事件比如有：

- 玩家占领城市随机出现损坏，需玩个小拼图游戏解决，否则不能出兵。
- 地图出现一些战争物资，消失前点击捡拾（类似瘟疫公司手动捡DNA）。
- 出现灾难事件，玩打地鼠游戏支援。

**历史知识及小说阅读**：玩游戏之外还有意外的收获

1. 玩家在等待占城或等待战斗期间可以阅读最新章节的小说。
2. 玩家点击某个城市图标时，有机率看到和这个城市相关的一段历史故事。



### 2.3 卡牌升级

玩家参与战斗获得的战利和占领城市的税收，可以用来升级卡牌来获得更大的单军作战能力。如果运气好卡牌的兵种、布阵和等级达到特定的组合，会化身为历史英雄（如凯撒牌、刘秀牌等，小说部分有叙述）而获得更多特性加成。



### 2.4 链外联盟

“联盟协作”这件事， 即使官方不设计，也必然会带来玩家各种线下讨论。我们组织了[Discord](https://discordapp.com/invite/pKQyyrP)群供玩家自由讨论与结盟。但离线联盟并无法决定玩家链上游戏行为。因为即使离线联盟相互十分信任攻守一致, 也无法防止同服其他陌生玩家搅局。精明的玩家也可以暗自从Discord讨论中分析战局的信息。





## IV 其他设计特色

除了上述最重要的创新的设计外，我们有如下设计细节：

### 1. 全逻辑上链

《卡莱战纪》为全逻辑上链游戏。除了某些图片资源的链接外，玩家无需依赖中心化逻辑服务器（本来也没有）游戏，甚至理论上无需客户端光靠钱包都可进行游戏。全逻辑上链（相比仅仅资产上链）的另一个好处是：**玩家资产不仅永远不会丢，而且永远能有用**。

### 2. 全平台移植

iPhone, 安卓与网页， 想玩就玩。卡莱战纪将配备Unity客户端，可无缝移植到iPhone, 安卓与页游。开发团队具有多年研发并运营百万用户级别游戏产品经验，将根据跨平台需求细致打造用户体验。

### 3. 信息补贴





## 常见疑问



**欢迎通过[Discord](<https://discord.gg/pKQyyrP> )提交问题，我们将尽快给予回答或讨论，以更好完善游戏设计。**



**Q: 不同服务器玩家, 看到的小说是一样的么?**

**答**：小说可以由作家玩家在链外论坛随意开博张贴连载，任何人（包括非玩家）都可以读。但是如果希望被投票上链从而获得代币奖励，该玩家只能在自己所在的分服里提交。也就是说同一篇章只可能成为特定某服的资产。 未来最著名的那部小说，其分服也会因此荣耀。

**Q: 如果某些服务器玩家对小说不感兴趣，也没人投票怎么办？**

**答**：吟游诗人可以赚钱也有短期内影响游戏逻辑的能力，所以一般情况下不会空缺。假如某分服没有小说传统，随便贴些烂文只求拉票也没问题。那样玩家投的就纯是人气。退一万步没人发布也没人投票, 那么一旦到时间将会顺着官方版本发布小说篇章。

**Q: 哪些数据是服务器隔离的, 我的卡牌可以和其它服玩家进行交易么?**

**答**：服务隔离的是一些游戏相关数据, 比如城市占领. 资产数据是全网统一的, 不同服玩家可以进行卡牌的交易.

**Q: 初期玩家, 一手烂牌如何生存?**

**答**：首先,卡牌的克制因素在对战成败中占有很大的权重, 所以尽量去攻打可以克制的玩家所占领的城市. 其次在攻打过程中, 尽量争去好友来做你的盟军，以多打一较容易取胜。另外由于[软分服](https://github.com/norchain/NEOCarryBattle/blob/master/%E5%8D%A1%E8%8E%B1%E6%88%98%E7%BA%AA-%E5%88%86%E6%9C%8D.md)的收益因子设置，一般而言等级差不多的玩家会聚拢在一个服务器里。

**Q: 正式可玩的版本什么时候上线？**

**答**：游戏还在开发中，预计2019年第一季度正式上neo主网。

**Q: 不占领城市，想和玩家相互打遭遇战可以么？**

**答**：暂无此设计安排。

**Q: 以后考不考虑增加国战？让我们为自己的国家扩大疆土？**

**答**：暂无此设计安排。

